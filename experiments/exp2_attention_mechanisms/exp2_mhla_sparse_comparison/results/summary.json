{
  "config": {
    "d_model": 512,
    "n_heads": 8,
    "n_layers": 6,
    "d_ff": 2048,
    "num_experts": 4,
    "expert_top_k": 2,
    "indexer_heads": 4,
    "indexer_dim": 64,
    "batch_size": 8,
    "steps": 500,
    "learning_rate": 0.003,
    "eval_every": 100,
    "max_tokens": 50000,
    "num_documents": 1000,
    "dropout": 0.1,
    "load_balancing_weight": 0.01,
    "device": "cuda",
    "q_lora_rank": null,
    "kv_lora_rank": 64,
    "qk_rope_head_dim": null,
    "qk_nope_head_dim": 0,
    "v_head_dim": null
  },
  "sequence_lengths": [
    64,
    128,
    256,
    1024,
    2048
  ],
  "results": [
    {
      "seq_len": 64,
      "baseline": {
        "val_loss": 7.433398353153399,
        "val_accuracy": 0.09152501001401962,
        "time_per_step": 0.0750902714729309,
        "parameters": 79252352
      },
      "sparse": {
        "val_loss": 6.640148159021751,
        "val_accuracy": 0.15458829861806528,
        "time_per_step": 0.07456614017486572,
        "parameters": 80247680
      }
    },
    {
      "seq_len": 128,
      "baseline": {
        "val_loss": 6.848331709961769,
        "val_accuracy": 0.10346745287748145,
        "time_per_step": 0.07583153343200684,
        "parameters": 79252352
      },
      "sparse": {
        "val_loss": 6.971209032109583,
        "val_accuracy": 0.10270139863645478,
        "time_per_step": 0.07827441596984863,
        "parameters": 80247680
      }
    },
    {
      "seq_len": 256,
      "baseline": {
        "val_loss": 6.607637961417928,
        "val_accuracy": 0.12470314384800965,
        "time_per_step": 0.08412821435928344,
        "parameters": 79252352
      },
      "sparse": {
        "val_loss": 6.554338412252257,
        "val_accuracy": 0.13228082906111782,
        "time_per_step": 0.08742089176177978,
        "parameters": 80247680
      }
    },
    {
      "seq_len": 1024,
      "baseline": {
        "val_loss": 4.102464914954826,
        "val_accuracy": 0.3215722397003267,
        "time_per_step": 0.08408131980895996,
        "parameters": 79252352
      },
      "sparse": {
        "val_loss": 6.908049638548359,
        "val_accuracy": 0.10664632842811926,
        "time_per_step": 0.08182365894317627,
        "parameters": 80247680
      }
    },
    {
      "seq_len": 2048,
      "baseline": {
        "val_loss": 6.643409636023146,
        "val_accuracy": 0.1186248492896246,
        "time_per_step": 0.07581126689910889,
        "parameters": 79252352
      },
      "sparse": {
        "val_loss": 6.6262787698580645,
        "val_accuracy": 0.14358798634645464,
        "time_per_step": 0.07661426973342896,
        "parameters": 80247680
      }
    }
  ]
}